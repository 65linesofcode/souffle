<!--
* Souffle - A Datalog Compiler
* Copyright (c) 2016, The Souffle Developers. All rights reserved
* Licensed under the Universal Permissive License v 1.0 as shown at:
* - https://opensource.org/licenses/UPL
* - <souffle root>/licenses/SOUFFLE-UPL.txt
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Souffle Profiler</title>
</head>
<link rel="stylesheet" type="text/css" href="style.css">
<link rel="stylesheet" type="text/css" href="chartiststyle.css">
<body>
<div id="wrapper" style="width:100%;height:inherit">
    <ul class="tab">
        <li><a href="javascript:void(0)" class="tablinks" onclick="changeTab(event, 'Help')">Help</a></li>
        <li><a href="javascript:void(0)" class="tablinks" id="default" onclick="changeTab(event, 'Top')">Top</a></li>
        <li><a href="javascript:void(0)" class="tablinks" onclick="changeTab(event, 'Relations')">Relations</a></li>
        <li><a href="javascript:void(0)" class="tablinks" onclick="changeTab(event, 'Rules')">Rules</a></li>
        <li id="chart_tab" style="display:none"><a href="javascript:void(0)" class="tablinks">Chart</a></li>
    </ul>
    <div id="Help" class="tabcontent" style="max-width:800px;margin-left: auto;margin-right: auto;">
        <h3>GUI Souffle profiler</h3>
        <p>Select Relation or Rules from the top bar to see a table of Relations or Rules</p>
        <p>Tables show:
            <ul>
        <li>Name/description</li>
        <li>ID(generated by profiler)</li>
        <li>Total time the rule/relation was being processed</li>
        <li>Non-recursive time (more detail needed?)</li>
        <li>Recursive time</li>
        <li>Copy time</li>
        <li>number of Tuples of the Rule/relation</li>
        <li>Percentage of time the rule/relation ran in comparison to the total</li>
        <li>Percentage of tuples generated by the rule/relation compared to the total</li>
        <li>The source location of the rule/relation in the datalog file</li>
    </ul></p>
        <p>The tables are sortable by all columns by clicking on the header. Number precision can be toggled by pressing the button at the top of the page to show either shorthand or full precision.</p>
        <p>In the relation tab, to see the rules of a relation, select a relation from the table, and a table of rules will appear below. Similary, by selecting a Rule in the Rule tab, a list of versions of the rule will show up (for recursive rules).</p>
        <p>To visualise a graph of a relation, select the relation from the Relations table, then press the graph selected button to show /I'm not sure exactly what this graphs/</p>
        <p>Similarly for a Rule, in the Rules table, select a rule, and go to the bottom, where you can either graph the selected rule's iterations or the versions of the selected rule.</p>
    </div>
    <div id="Top" class="tabcontent" style="max-width:800px;margin-left: auto;margin-right: auto;">
        <h3>Top</h3>
    </div>
    <div id="Relations" class="tabcontent">
        <h3>Relations table</h3>
        <button onclick="toggle_precision()">Toggle number precision</button>
        <button onclick="graph_rel()">Graph selected</button>
        <div style="max-height:60vh; overflow-y:scroll;">
        <table id='Rel_table'>
            <thead>
            <tr>
                <th data-sort-method="text" style="width:80%">Name</th>
                <th data-sort-method="text">ID</th>
                <th data-sort-method="time">Total Time</th>
                <th data-sort-method="time">Non Rec Time</th>
                <th data-sort-method="time">Rec Time</th>
                <th data-sort-method="time">Copy Time</th>
                <th data-sort-method="number">Tuples</th>
                <th data-sort-method="number">% of Time</th>
                <th data-sort-method="number">% of Tuples</th>
                <th data-sort-method="text" style="width:20%">Source</th>
            </tr>
            </thead>
            <tbody id="Rel_table_body">
            </tbody>
        </table>
        </div>
        <hr/>
        <div id="rulesofrel" style="display:none">
            <h3>Rules of Relation</h3>
            <p>Graph relation selected below (ID begins with R)</p>
            <div style="max-height:60vh; overflow-y:scroll;">
            <table id="rulesofrel_table">
                <thead>
                <tr>
                    <th data-sort-method="text" style="width:80%">Name</th>
                    <th data-sort-method="text">ID</th>
                    <th data-sort-method="time">Total Time</th>
                    <th data-sort-method="time">Non Rec Time</th>
                    <th data-sort-method="time">Rec Time</th>
                    <th data-sort-method="time">Copy Time</th>
                    <th data-sort-method="number">Tuples</th>
                    <th data-sort-method="number">% of Time</th>
                    <th data-sort-method="number">% of Tuples</th>
                    <th data-sort-method="text" style="width:20%">Source</th>
                </tr>
                </thead>
                <tbody id="rulesofrel_body">

                </tbody>
            </table>
            </div>
        </div>
    </div>
    <div id="Rules" class="tabcontent">
        <h3>Rules table</h3>
        <button onclick="toggle_precision()">Toggle number precision</button>
        <button onclick="graph_rul()">Graph selected</button>
        <button onclick="graph_rul_ver()">Graph versions of selected</button>
        <div style="max-height:60vh; overflow-y:scroll;">
        <table id='Rul_table'>
            <thead>
            <tr>
                <th data-sort-method="text" style="width:80%">Name</th>
                <th data-sort-method="text">ID</th>
                <th data-sort-method="time">Total Time</th>
                <th data-sort-method="time">Non Rec Time</th>
                <th data-sort-method="time">Rec Time</th>
                <th data-sort-method="time">Copy Time</th>
                <th data-sort-method="number">Tuples</th>
                <th data-sort-method="number">% of Time</th>
                <th data-sort-method="number">% of Tuples</th>
                <th data-sort-method="text" style="width:20%">Source</th>
            </tr>
            </thead>
            <tbody id="Rul_table_body">
            </tbody>
        </table>
        </div>
        <hr/>
        <div id="rulver" style="display:none">
            <h3>Rule Versions Table</h3>

            <div style="max-height:60vh; overflow-y:scroll;">
            <table id='rulvertable'>
                <thead>
                <tr>
                    <th data-sort-method="text" style="width:80%">Name</th>
                    <th data-sort-method="text">ID</th>
                    <th data-sort-method="time">Total Time</th>
                    <th data-sort-method="time">Non Rec Time</th>
                    <th data-sort-method="time">Rec Time</th>
                    <th data-sort-method="time">Copy Time</th>
                    <th data-sort-method="number">Tuples</th>
                    <th data-sort-method="number">Ver</th>
                    <th data-sort-method="number">% of Time</th>
                    <th data-sort-method="number">% of Tuples</th>
                    <th data-sort-method="text" style="width:20%">Source</th>
                </tr>
                </thead>
                <tbody id="rulver_body">
                </tbody>
            </table>
            </div>
        </div>
    </div>
    <div id="chart" class="tabcontent">
        <button>TODO: back button</button>
        <p>Also a label of what the graph is. Or show it underneath the table on other tab??</p>
        <h1>Total run time</h1>
        <div class="ct-chart1"></div>
        <h1>Total number of tuples</h1>
        <div class="ct-chart2"></div>
        <!--<h1>Copy time</h1>-->
        <!--<div class="ct-chart1"></div>-->
        <button onclick="show_graph_vals=!show_graph_vals;draw_graph();">Toggle values</button>
    </div>
</div>

</body>
<script src="chartist_tablesort.js"></script>
<script src="testdata.js"></script>
<script src="util.js"></script>
<script src="page_functions.js"></script>
</html>